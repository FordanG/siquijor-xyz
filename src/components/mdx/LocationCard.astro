---
import { getGoogleMapsUrl, formatPrice } from '@/utils/helpers';

interface Props {
  name: string;
  coordinates?: { lat: number; lng: number };
  description?: string;
  hours?: string;
  fee?: string | number;
  rating?: number;
}

const { name, coordinates, description, hours, fee, rating } = Astro.props;

const mapsUrl = coordinates ? getGoogleMapsUrl(coordinates.lat, coordinates.lng, name) : null;
const displayFee = typeof fee === 'number' ? formatPrice(fee) : fee;
---

<div class="bg-white dark:bg-volcanic-800 rounded-xl border border-stone-200 dark:border-volcanic-700 p-4 my-6">
  <div class="flex items-start gap-4">
    <!-- Map Icon -->
    <div class="w-12 h-12 rounded-lg bg-jungle-100 dark:bg-jungle-900/30 flex items-center justify-center flex-shrink-0">
      <svg class="w-6 h-6 text-jungle-600 dark:text-jungle-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
        <circle cx="12" cy="10" r="3"></circle>
      </svg>
    </div>

    <!-- Content -->
    <div class="flex-1 min-w-0">
      <div class="flex items-start justify-between gap-2">
        <h4 class="font-semibold text-stone-900 dark:text-stone-100">
          {name}
        </h4>
        {rating && (
          <div class="flex items-center gap-1 text-sm text-amber-600">
            <svg class="w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>
            <span class="font-medium">{rating}</span>
          </div>
        )}
      </div>

      {description && (
        <p class="text-sm text-stone-600 dark:text-volcanic-400 mt-1">
          {description}
        </p>
      )}

      <!-- Details -->
      <div class="flex flex-wrap items-center gap-x-4 gap-y-2 mt-3 text-sm text-stone-500 dark:text-volcanic-400">
        {hours && (
          <span class="flex items-center gap-1">
            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            {hours}
          </span>
        )}

        {displayFee && (
          <span class="flex items-center gap-1">
            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
            {displayFee}
          </span>
        )}

        {mapsUrl && (
          <a
            href={mapsUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center gap-1 text-jungle-700 dark:text-amber-400 hover:underline"
          >
            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
              <polyline points="15 3 21 3 21 9"></polyline>
              <line x1="10" x2="21" y1="14" y2="3"></line>
            </svg>
            Open in Maps
          </a>
        )}
      </div>
    </div>
  </div>
</div>
